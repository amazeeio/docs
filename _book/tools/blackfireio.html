
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Blackfire.io Â· docs.amazee.io</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-atoc/atoc.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-hints/plugin-hints.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-advanced-emoji/emoji-website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="xdebug.html" />
    
    
    <link rel="prev" href="../tools.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://www.amazee.io" target="_blank" class="custom-link">www.amazee.io</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../step_by_step_guides/step_by_step_guides.html">
            
                <a href="../step_by_step_guides/step_by_step_guides.html">
            
                    
                    Step by Step Guides
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../step_by_step_guides/technical_requirements.html">
            
                <a href="../step_by_step_guides/technical_requirements.html">
            
                    
                    Technical Requirements
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../step_by_step_guides/get_your_drupal_site_running_on_amazeeio.html">
            
                <a href="../step_by_step_guides/get_your_drupal_site_running_on_amazeeio.html">
            
                    
                    Get your Drupal Site locally running
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../step_by_step_guides/push-local-site-to-development-server.html">
            
                <a href="../step_by_step_guides/push-local-site-to-development-server.html">
            
                    
                    Push local site to development server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../step_by_step_guides/grant_amazeeio_access_to_sourcecode.html">
            
                <a href="../step_by_step_guides/grant_amazeeio_access_to_sourcecode.html">
            
                    
                    Grant access to your sourcecode
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../step_by_step_guides/golive_on_amazeeio.html">
            
                <a href="../step_by_step_guides/golive_on_amazeeio.html">
            
                    
                    Going Live
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../local_docker_development/local_docker_development.html">
            
                <a href="../local_docker_development/local_docker_development.html">
            
                    
                    Local Docker Development
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../local_docker_development/pygmy.html">
            
                <a href="../local_docker_development/pygmy.html">
            
                    
                    Linux & OS X - pygmy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../local_docker_development/os_x_cachalot.html">
            
                <a href="../local_docker_development/os_x_cachalot.html">
            
                    
                    OS X Alternative - cachalot
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../local_docker_development/windows.html">
            
                <a href="../local_docker_development/windows.html">
            
                    
                    Windows
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../local_docker_development/drupal_site_containers.html">
            
                <a href="../local_docker_development/drupal_site_containers.html">
            
                    
                    Drupal Docker Containers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" data-path="../local_docker_development/connect_to_mysql_from_external.html">
            
                <a href="../local_docker_development/connect_to_mysql_from_external.html">
            
                    
                    Connect to MySQL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.2" data-path="../local_docker_development/map_addtitional_ports.html">
            
                <a href="../local_docker_development/map_addtitional_ports.html">
            
                    
                    Map additional ports
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../local_docker_development/troubleshooting.html">
            
                <a href="../local_docker_development/troubleshooting.html">
            
                    
                    Troubleshooting
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../architecture/architecture.html">
            
                <a href="../architecture/architecture.html">
            
                    
                    Architecture
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../architecture/stack-types.html">
            
                <a href="../architecture/stack-types.html">
            
                    
                    Stack-Types
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../architecture/stack-types/compact.html">
            
                <a href="../architecture/stack-types/compact.html">
            
                    
                    Compact Stack
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="../architecture/stack-types/cluster.html">
            
                <a href="../architecture/stack-types/cluster.html">
            
                    
                    Cluster Stack
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../architecture/components.html">
            
                <a href="../architecture/components.html">
            
                    
                    Stack Components
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../architecture/environment_type.html">
            
                <a href="../architecture/environment_type.html">
            
                    
                    Environment type
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../architecture/e-mail_delivery.html">
            
                <a href="../architecture/e-mail_delivery.html">
            
                    
                    E-Mail Delivery
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../architecture/url-structure.html">
            
                <a href="../architecture/url-structure.html">
            
                    
                    URL Structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../architecture/varnish_testing.html">
            
                <a href="../architecture/varnish_testing.html">
            
                    
                    Varnish Testing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../automated_deployments.html">
            
                <a href="../automated_deployments.html">
            
                    
                    Automated Deployments
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../drupal/amazeeioyml_file.html">
            
                <a href="../drupal/amazeeioyml_file.html">
            
                    
                    .amazeeio.yml file
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../drupal/example-for-drupal-7.html">
            
                <a href="../drupal/example-for-drupal-7.html">
            
                    
                    example for Drupal 7
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../drupal/example-for-drupal-8.html">
            
                <a href="../drupal/example-for-drupal-8.html">
            
                    
                    example for Drupal 8 without composer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../drupal/example-for-drupal-8-with-composer.html">
            
                <a href="../drupal/example-for-drupal-8-with-composer.html">
            
                    
                    example for Drupal 8 with composer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../drupal/automatic-synchronization-of-sites.html">
            
                <a href="../drupal/automatic-synchronization-of-sites.html">
            
                    
                    Automatic synchronization of sites
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../environment_variables.html">
            
                <a href="../environment_variables.html">
            
                    
                    Environment Variables
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../drupal/drupal.html">
            
                <a href="../drupal/drupal.html">
            
                    
                    Drupal & Drush
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../drupal/settingsphpfiles.html">
            
                <a href="../drupal/settingsphpfiles.html">
            
                    
                    Drupal Configuration and settings.php
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../drupal/drush-configuration-files.html">
            
                <a href="../drupal/drush-configuration-files.html">
            
                    
                    Drush Configuration Files
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../drupal/synchronize_sites.html">
            
                <a href="../drupal/synchronize_sites.html">
            
                    
                    Synchronize Sites
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../drupal/drush9.html">
            
                <a href="../drupal/drush9.html">
            
                    
                    Drush 9
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../tools.html">
            
                <a href="../tools.html">
            
                    
                    Tools
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.9.1" data-path="blackfireio.html">
            
                <a href="blackfireio.html">
            
                    
                    Blackfire.io
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="xdebug.html">
            
                <a href="xdebug.html">
            
                    
                    Xdebug
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../add-on/add-on.html">
            
                <a href="../add-on/add-on.html">
            
                    
                    Add-ons
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../add-on/cdn_integration.html">
            
                <a href="../add-on/cdn_integration.html">
            
                    
                    CDN Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../add-on/dropguard.html">
            
                <a href="../add-on/dropguard.html">
            
                    
                    Dropguard
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="../add-on/newrelic.html">
            
                <a href="../add-on/newrelic.html">
            
                    
                    New Relic
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../customizations.html">
            
                <a href="../customizations.html">
            
                    
                    Customization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../customization/solr.html">
            
                <a href="../customization/solr.html">
            
                    
                    Solr Customization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="../customization/nginx.html">
            
                <a href="../customization/nginx.html">
            
                    
                    nginx Customization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="../customization/docker.html">
            
                <a href="../customization/docker.html">
            
                    
                    Docker Customization
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../support.html">
            
                <a href="../support.html">
            
                    
                    Support
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../regular_maintenance.html">
            
                <a href="../regular_maintenance.html">
            
                    
                    Regular Maintenance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../changelog.html">
            
                <a href="../changelog.html">
            
                    
                    Changelog
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../faq.html">
            
                <a href="../faq.html">
            
                    
                    FAQ
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    
<div class="alert-danger hints-alert">
    <div class="hints-icon"><i class="fa fa-exclamation-circle"></i></div>
    <div class="hints-container">
        <p>This is the legacy documentation of the amazee.io infrastructure. If you are using Lagoon please head over
            to the <a href="https://lagoon.readthedocs.io">Lagoon Documentation</a></p>
    </div>
</div>



                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
                                <section class="normal markdown-section">
                                
                                <h1 id="blackfireio">Blackfire.io</h1>
<p><a href="https://blackfire.io" target="_blank">Blackfire.io</a> is the preferred way by amazee.io to profile your Drupal sites. Over are the times to handle clunky weird xhprof configurations and other things.</p>
<p>At amazee.io we ship Blackfire with every Local Drupal Development site and it is enabled on all development and production sites.</p>
<p>It is easily configured and setup:</p>
<h2 id="initial-setup">Initial Setup</h2>
<ol>
<li>In order to use Blackfire.io you need an Blackfire.io account, which is completely free! <a href="https://blackfire.io/signup" target="_blank">Create one right now.</a></li>
<li>Visit <a href="https://blackfire.io/account" target="_blank">your Blackfire.io account</a> and copy the <code>Server ID</code> and <code>Server Token</code> from the <em>My Server Credentials</em> section (not the <em>My Client Credentials</em> section!)</li>
</ol>
<p><img src="../assets/Account_-_Blackfire.jpg" alt=""></p>
<h2 id="local-docker-development-with-blackfire-chrome-companion">Local Docker Development with Blackfire Chrome Companion</h2>
<ol>
<li>Install the <a href="https://blackfire.io/docs/integrations/chrome" target="_blank">Blackfire Chrome Companion</a></li>
<li>Find the commented Blackfire section inside your <code>docker-compose.yml</code> file (see an example <a href="https://github.com/amazeeio/docker/blob/master/example-php70-basic.yml#L13" target="_blank">here</a>)</li>
<li><p>Uncomment the lines <code>BLACKFIRE_SERVER_ID</code> and <code>BLACKFIRE_SERVER_TOKEN</code> and add the  information from your Blackfire.io account. Example:</p>
<pre><code> services:
   drupal:
     hostname: &amp;hostname mysite.docker.amazee.io
     environment:
       BLACKFIRE_SERVER_ID: bdda64f6-7c4f-4ec5-be32-f1a6f5680cb0
       BLACKFIRE_SERVER_TOKEN: fcc9ec9e54ffb4a35a5fcf7376f462eb85fe47e9fc978ed1df067c8b82afe500
</code></pre></li>
<li><p>restart your Docker container if it is running:</p>
<pre><code> docker-compose up -d --force-recreate
</code></pre></li>
<li><p>Visit your local Docker site (in this example <a href="http://mysite.docker.amazee.io\" target="_blank">http://mysite.docker.amazee.io\</a>)</p>
</li>
<li><p>Click on the Blackfire Chrome Companion Icon, select &quot;Profile&quot; and after a couple of seconds you will have local site profiled.</p>
</li>
<li><p>Read more at <a href="https://blackfire.io/docs/reference-guide/analyzing-profiles" target="_blank">Analyzing Profiles</a> about the Profiles that Blackfire generates.</p>
</li>
</ol>
<h2 id="local-docker-development-with-blackfire-cli-tool">Local Docker Development with <code>blackfire</code> CLI tool</h2>
<p>Every amazee.io Docker image has the <code>blackfire</code> CLI tool already installed, so you can use that instead of the Chrome Companion. Learn more about the profiling of HTTP Request at the <a href="https://blackfire.io/docs/cookbooks/profiling-http" target="_blank">Blackfire documentation</a>.</p>
<ol>
<li>Follow Steps 2-4 from <em>Local Docker Development with Blackfire Chrome Companion</em></li>
<li>Connect to the Docker Container</li>
<li>Run the <code>blackfire</code> command with defining the client-id and client-token from your <a href="https://blackfire.io/account" target="_blank">your Blackfire.io account</a>, example:<pre><code>blackfire --client-id=&quot;5f12d5ef-5b63-4d16-9bd8-2c741fe6a3ed&quot; --client-token=&quot;13210acce473f9d8f485f19088f8b0b83c03bc2938efface72b9de1506ed211d&quot; curl http://mysite.docker.amazee.io/
</code></pre></li>
</ol>
<h2 id="development-and-production-sites">Development and Production sites</h2>
<p>One of the greatness of Blackfire is the capability to profile on development and production sites without harm. This is possible as each request from a Blackfire client is authenticated via the Client-ID and the Client-Token and ensured that this client has the authority to profile a specific site. Plus the Blackfire PHP module does nothing when you are not profiling, so it does not add any overhead to a regular request.</p>
<p>In order to profile your development or production sites, just pass the amazee.io team your <code>Server ID</code> and <code>Server Token</code> from your <a href="https://blackfire.io/account" target="_blank">Blackfire.io account,</a> we will then deploy these keys to all your sites and you can start to profile in no time!</p>
<h2 id="triggering-blackfire-scenarios-after-deployments">Triggering Blackfire Scenarios after deployments</h2>
<p>Another great feature of Blackfire: You can profile and test fully automatically without you needing to do anything. Blackfire will tell you exactly if a deployment made your site faster or slower! This is an Enterprise feature only though, but they are worth the price, never has been automated profiling been easier. <a href="../mailto:support@amazee.io">Talk to us</a> if you are interested in a discount on Blackfire Enterprise!</p>
<p>Blackfire calls them Scenarios and they are based on Tests. Read more about them <a href="https://blackfire.io/docs/cookbooks/scenarios" target="_blank">over at the Blackfire docs</a>. After you have defined your Tests and Scenarios, you need to trigger them after a deployment. This happens within the <code>.amazeeio.yml</code> file within a deploy task.</p>
<p>The best practice is to add them add the last step within the <code>after_deploy</code> task list. Please see the <a href="https://blackfire.io/docs/reference-guide/builds-and-integrations#start-build-with-api" target="_blank">Trigger API documentation</a> from Blackfire on how to call a trigger via curl or the blackfire tool (which is also installed on all development and production sites).</p>
<p>Hint hint: the API needs to know the URL of the site to test via the <code>endpoint</code> parameter, we provide you the <code>AMAZEEIO_BASE_URL</code> environment variable which contains exactly that.</p>

                                
                                </section>
                            
                        </div>
                    </div>
                
            </div>

            
                
                <a href="../tools.html" class="navigation navigation-prev " aria-label="Previous page: Tools">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="xdebug.html" class="navigation navigation-next " aria-label="Next page: Xdebug">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Blackfire.io","level":"1.9.1","depth":2,"next":{"title":"Xdebug","level":"1.9.2","depth":2,"path":"tools/xdebug.md","ref":"tools/xdebug.md","articles":[]},"previous":{"title":"Tools","level":"1.9","depth":1,"path":"tools.md","ref":"tools.md","articles":[{"title":"Blackfire.io","level":"1.9.1","depth":2,"path":"tools/blackfireio.md","ref":"tools/blackfireio.md","articles":[]},{"title":"Xdebug","level":"1.9.2","depth":2,"path":"tools/xdebug.md","ref":"tools/xdebug.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["atoc","copy-code-button","heading-anchors","hints","advanced-emoji","-lunr","-search"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"atoc":{},"hints":{"danger":"fa fa-exclamation-circle","info":"fa fa-info-circle","tip":"fa fa-mortar-board","working":"fa fa-wrench"},"fontsettings":{"theme":"white","family":"sans","size":2},"heading-anchors":{},"highlight":{},"copy-code-button":{},"advanced-emoji":{"embedEmojis":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"docs.amazee.io","links":{"sidebar":{"www.amazee.io":"https://www.amazee.io"}},"gitbook":"*"},"file":{"path":"tools/blackfireio.md","mtime":"2017-09-11T11:13:32.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2020-10-27T11:18:30.250Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-atoc/atoc.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/1.2.1/anchor.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-heading-anchors/anchor-style.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

